<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Entity Component System (Specialization) - Natdanai Puthom</title><meta name="description" content="(this article is inprogress of writing) In this post, I'll assume the reader already has some idea of what an&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://natdanaiputhom.github.io/entity-component-system/"><link rel="alternate" type="application/atom+xml" href="https://natdanaiputhom.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://natdanaiputhom.github.io/feed.json"><meta property="og:title" content="Entity Component System (Specialization)"><meta property="og:image" content="https://natdanaiputhom.github.io/media/posts/6/ecs2-2.png"><meta property="og:image:width" content="1231"><meta property="og:image:height" content="657"><meta property="og:site_name" content="Natdanai Puthom"><meta property="og:description" content="(this article is inprogress of writing) In this post, I'll assume the reader already has some idea of what an&hellip;"><meta property="og:url" content="https://natdanaiputhom.github.io/entity-component-system/"><meta property="og:type" content="article"><link rel="preload" href="https://natdanaiputhom.github.io/assets/dynamic/fonts/gluten/gluten.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://natdanaiputhom.github.io/assets/css/style.css?v=59031aa59d81a4b7c5a63309c7c76b5c"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://natdanaiputhom.github.io/entity-component-system/"},"headline":"Entity Component System (Specialization)","datePublished":"2024-04-08T11:17","dateModified":"2024-05-27T00:59","image":{"@type":"ImageObject","url":"https://natdanaiputhom.github.io/media/posts/6/ecs2-2.png","height":657,"width":1231},"description":"(this article is inprogress of writing) In this post, I'll assume the reader already has some idea of what an&hellip;","author":{"@type":"Person","name":"Natdanai Puthom","url":"https://natdanaiputhom.github.io/authors/natdanai-puthom/"},"publisher":{"@type":"Organization","name":"Natdanai Puthom"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="container"><header class="header"><a href="https://natdanaiputhom.github.io/" class="logo"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu">Menu</button><ul class="navbar__menu"><li><a href="https://natdanaiputhom.github.io/" target="_self">Home</a></li><li><a href="https://natdanaiputhom.github.io/tags/personal-project/" target="_self">Personal Projects</a></li><li><a href="https://natdanaiputhom.github.io/tags/group-project/" target="_self">Group Projects</a></li><li><a href="https://natdanaiputhom.github.io/tags/gamejam/" target="_self">Game Jams</a></li><li><a href="https://natdanaiputhom.github.io/about-me/" target="_self">About me</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__inner post__header"><h1 class="post__title">Entity Component System (Specialization)</h1></header><div class="post__inner"><div class="post__entry"><p><strong>(this article is inprogress of writing)</strong></p><div class="content"><div class="textLeft"><h5><strong>Introduction</strong></h5><p>In this post, I'll assume the reader already has some idea of what an Entity Component System (ECS) is and will dive straight into my variant of ECS. This variant intentionally diverges from some ECS principles due to specific design choices and limitations in knowledge, experience, and time. My interest in ECS began with game project 5 at The Game Assembly (TGA), but it was actually in game project 6 where I started to delve deeper into learning about ECS.</p><p>From my experience, people find it easier to understand and use architectures like Unity, where game objects contain their components and logic. At TGA, my team tried using FLECS, but despite its excellent documentation, it was challenging to learn within our limited timeframe, causing bottlenecks in gameplay and other systems due to our skill limitations.</p><p>Therefore, I would like to try implementing an ECS variant that strikes a balance between a simple user interface and performance. A design that minimizes the possibility of mistakes.</p></div><div class="image"><figure class="post_image"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/ecs2.png" alt="" width="1580" height="1580" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/ecs2-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs2-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs2-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs2-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs2-xl.png 1600w"></figure></div></div><div class="content"><div class="textLeft"><h5><strong>Goal</strong></h5><p>My aim is to develop a straightforward ECS design that mirrors Unity's functionality and is user-friendly for editors, node scripters, and gameplay programmers alike. Most importantly, I aim to enjoy and learn from the process of implementing this design.</p><blockquote><p class="msg msg--highlight">It has always been simple. It just was never easy.</p></blockquote></div></div><div class="content"><div class="textLeft"><h5><strong>Example</strong></h5><p><em>This isn't the final outcome</em>.</p><p>The GIF below demonstrates the RenderSystem in action, interacting with an Entity that contains components such as Transform, Mesh and Animated.</p><p><em>(Both models are made by me in Blender and I haven't manage to learn how to fix uv yet. Engine side is working correctly ðŸ˜€Â )Â </em></p><div class="ImageContainerWithText"><div class="image-container"><a href="https://natdanaiputhom.github.io/ecs_dragdrop.gif" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/ecs_dragdrop.gif" alt="" width="512" height="512"></a></div><div class="text-container"><strong>Entity1 has Transform, Mesh, Animated and AnimationController component</strong></div></div></div><div class="ImageContainerWithText"><div class="image-container"><a href="https://natdanaiputhom.github.io/ecs_usage.png" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/ecs_usage.png" alt="" width="512" height="512" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/ecs_usage-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs_usage-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs_usage-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs_usage-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs_usage-xl.png 1600w"></a></div><div class="text-container">Here's an example of how ECS is initialized and can be used.</div></div></div><div class="content"><div class="textLeft"><h5><strong>Overview</strong></h5><p>Some fundamental include:</p><ul><li>Create/Remove Entities</li><li>Create/Remove Component of type T</li><li>Get all components of type T</li><li>Get all entities</li></ul><ul><li>EntityManager</li><li>ComponentManager</li><li>SystemManager</li><li>MemoryPools</li><li>Entity &amp; IEntity &amp; Entities</li><li>And more</li></ul></div><div class="image"><a href="https://natdanaiputhom.github.io/ecs.png" target="_blank" rel="noopener noreferrer"><figure class="post_image"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/ecs.png" alt="" width="1580" height="600" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/ecs-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/ecs-xl.png 1600w"></figure></a></div></div><div class="content"><div class="textLeft"><h5><strong>Entity</strong></h5><p>This interface is for Entity, hence it is called IEntity. Users cannot store or create IEntity directly; they must use the EntityManager, which acts as a factory. For debugging purposes during implementation, I've added std::string and padding to reach 64 bytes per IEntity class. I plan to remove these in the future and instead use name and tag components, reducing the IEntity class to 16 bytes.</p><div class="image"><a href="https://natdanaiputhom.github.io/entityinterface.png" target="_blank" rel="noopener noreferrer"><figure class="post_image"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/entityinterface.png" alt="" width="256" height="256" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/entityinterface-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/entityinterface-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/entityinterface-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/entityinterface-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/entityinterface-xl.png 1600w"></figure></a></div><p>Entity is defined as 'IEntity* const&amp;'. Why? I wonder the same. It has caused me quite a headache but there's a reason for this, which I'll explain in a bit down this post.</p></div><div class="image"><a href="https://natdanaiputhom.github.io/entity.png" target="_blank" rel="noopener noreferrer"><figure class="post_image"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/entity.png" alt="" width="512" height="512" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/entity-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/entity-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/entity-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/entity-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/entity-xl.png 1600w"></figure></a></div></div><div class="content"><div class="textLeft"><h5><strong>EntityManager</strong></h5><p>All entities created via EntityManager are stored in an EntityPool, a memory pool dedicated to creating and storing IEntity objects. The EntityManager class assigns unique IDs to entities and keeps track of them.</p><p>You may have noticed the presence of "myRemovedEntityIDs". At the time, I had planned to create an object pool for entities and components, but I ultimately decided to postpone it due to the complications it introduced and if it was even worth it?</p><div class="image"><a href="https://natdanaiputhom.github.io/entitypool.png" target="_blank" rel="noopener noreferrer"><figure class="post_image"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/entitypool.png" alt="" width="1024" height="1024" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/entitypool-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/entitypool-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/entitypool-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/entitypool-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/entitypool-xl.png 1600w"></figure></a></div></div><div class="image"><a href="https://natdanaiputhom.github.io/EntityManager.png" target="_blank" rel="noopener noreferrer"><figure class="post_image"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/EntityManager.png" alt="" width="512" height="512" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/EntityManager-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/EntityManager-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/EntityManager-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/EntityManager-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/EntityManager-xl.png 1600w"></figure></a></div></div><div class="content"><div class="textLeft"><h5><strong>ComponentManager</strong></h5><p>The ComponentManager functions similarly to the EntityManager, but it contains an unordered map that holds ComponentPools. This design allows for quick retrieval of all components of type T. Additionally, if the ComponentID is known, a constant-time lookup can be used to retrieve a single component. Finally, the ComponentManager includes a map for calling the destructor of components.</p></div><div class="image"><a href="https://natdanaiputhom.github.io/componentManager.png" target="_blank" rel="noopener noreferrer"><figure class="post_image"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/componentManager.png" alt="" width="512" height="512" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/componentManager-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/componentManager-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/componentManager-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/componentManager-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/componentManager-xl.png 1600w"></figure></a></div></div><div class="content"><div class="textLeft"><h5><strong>SystemManager</strong></h5><p>The SystemManager is the most straightforward. It simply manages all systems that have been added and updates them in the order of EarlyUpdate, FixedUpdate, Update, and LateUpdate, including rendering.</p><div class="image"><a href="https://natdanaiputhom.github.io/systemupdate.png" target="_blank" rel="noopener noreferrer"><figure class="post_image"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/systemupdate-2.png" alt="" width="1580" height="1580" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/systemupdate-2-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/systemupdate-2-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/systemupdate-2-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/systemupdate-2-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/systemupdate-2-xl.png 1600w"></figure></a></div></div><div class="image"><a href="https://natdanaiputhom.github.io/systemmanager.png" target="_blank" rel="noopener noreferrer"><figure class="post_image"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/systemmanager.png" alt="" width="1580" height="1580" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/systemmanager-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/systemmanager-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/systemmanager-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/systemmanager-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/systemmanager-xl.png 1600w"></figure></a></div></div><div class="content"><div class="textLeft"><h5><strong>Entities</strong></h5><p>This specialized class interface is designed for managing entities, ensuring that changes to original entities are reflected accurately when the EntityPool reallocates its size and relocates addresses. This approach prevents users from encountering dangling pointers due to reallocation issues. Accessing entities through this interface is as straightforward as accessing an array. Furthermore, I plan to enhance this interface to filter commonly used entities, such as those with a transform or mesh component, making them easily accessible for various systems.</p><p>The Entities class operator[] returns an Entity, which is of type 'IEntity*const&amp;'. This aspect presents a challenge for me to decide upon. The reason is straightforward: I require a reference to a pointer to accurately reflect changes to the Entity, whether it involves removal or relocation of memory address. Simultaneously, I must make it 'const' to prevent accidental reassignment to another entity or nullptr, which could lead to significant issues withing EntityPool.</p><p>Â </p></div><div class="image"><a href="https://natdanaiputhom.github.io/entities.png" target="_blank" rel="noopener noreferrer"><figure class="post_image"><img loading="lazy" src="https://natdanaiputhom.github.io/media/posts/6/entities.png" alt="" width="1580" height="1580" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://natdanaiputhom.github.io/media/posts/6/responsive/entities-xs.png 384w, https://natdanaiputhom.github.io/media/posts/6/responsive/entities-sm.png 600w, https://natdanaiputhom.github.io/media/posts/6/responsive/entities-md.png 768w, https://natdanaiputhom.github.io/media/posts/6/responsive/entities-lg.png 1200w, https://natdanaiputhom.github.io/media/posts/6/responsive/entities-xl.png 1600w"></figure></a></div></div><div class="content"><div class="textLeft"><h5><strong>Discussion</strong></h5><h6>Entity (IEntity*const&amp;)</h6><p>Using a reference for Entity prevents straightforward storage in a standard std::vector. I've opted to store these specific entities indirectly through EntityID. However, this approach requires multiple memory access operations when accessing entities via their IDs, which is not the most efficient method. Nonetheless, after profiling and considering my limited understanding of assembly, it appears that the performance impact of these multiple indirect accesses is currently insignificant. Consequently, I've contemplated using double pointers instead, but this would introduce an additional layer of indirect access. Additionally, it wasn't as user-friendly when attempting to use or pass them as arguments, for example *Entity-&gt;AddComponent&lt;T&gt;().</p></div></div></div><footer class="post__footer"><div class="post__tag-share"><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fnatdanaiputhom.github.io%2Fentity-component-system%2F" class="js-share facebook" aria-label="Share with Facebook" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://natdanaiputhom.github.io/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fnatdanaiputhom.github.io%2Fentity-component-system%2F" class="js-share linkedin" aria-label="Share with LinkedIn" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://natdanaiputhom.github.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div></div></footer></div></article></main><footer class="footer"><div class="footer__left"><div class="footer__copy"></div></div><div class="footer__right"><div class="footer__social"><a href="https://www.linkedin.com/in/natdanai-puthom-34175317a/" aria-label="LinkedIn" class="linkedin"><svg><use xlink:href="https://natdanaiputhom.github.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://natdanaiputhom.github.io/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script defer="defer" src="https://natdanaiputhom.github.io/assets/js/scripts.min.js?v=6450cfc483efd7e58ed8ad5b64050d3e"></script><script>function publiiDetectLoadedImages () {
         var images = document.querySelectorAll('img[loading]:not(.is-loaded)');
         for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
               images[i].classList.add('is-loaded');
               images[i].parentNode.classList.remove('is-img-loading');
            } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
                  this.parentNode.classList.remove('is-img-loading');
               }, false);
            }
         }
      }
      publiiDetectLoadedImages();</script></body></html>